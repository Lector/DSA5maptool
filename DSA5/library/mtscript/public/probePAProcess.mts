[h: uebergabe = macro.args]
[h: switchToken(json.get(uebergabe, "token"))]
[h: waffe = decode(json.get(uebergabe, "waffe"))]
[h: uebergabe = json.set(uebergabe, "Wert", json.get(waffe, "PA"))]

[h: technik = json.get(waffe, "Technik")]
[h,if(technik == "Raufen" || technik == ""): tabelle = "patzerWaffenlos"; tabelle = "patzerNahkampf"]
[h: uebergabe = json.set(uebergabe, "patzerTabelle", tabelle)]
[h: wName = json.get(waffe, "Name")]
[h: uebergabe = json.set(uebergabe, "Name", json.get(uebergabe, "ManName") + " mit "+ wName)]
[h: uebergabe = json.set(uebergabe, "pruefreroll", hasTrait("Vorteile", "Waffenbegabung ("+technik+")"))]
[h: verteidigungSchadenProcess(uebergabe)]